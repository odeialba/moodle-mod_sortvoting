{"version":3,"file":"sortvoting.min.js","sources":["../src/sortvoting.js"],"sourcesContent":["// This program is free software: you can redistribute it and/or modify\n// it under the terms of the GNU General Public License as published by\n// the Free Software Foundation, either version 3 of the License, or\n// (at your option) any later version.\n//\n// This program is distributed in the hope that it will be useful,\n// but WITHOUT ANY WARRANTY; without even the implied warranty of\n// MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\n// GNU General Public License for more details.\n//\n// You should have received a copy of the GNU General Public License\n// along with this program.  If not, see <https://www.gnu.org/licenses/>.\n\n/**\n * AMD module used when saving a new sort voting.\n *\n * @module      mod_sortvoting/issues-list\n * @copyright   2023 Odei Alba <odeialba@odeialba.com>\n * @license     https://www.gnu.org/copyleft/gpl.html GNU GPL v3 or later\n */\n\nimport Notification from 'core/notification';\nimport Ajax from 'core/ajax';\n\nconst SELECTORS = {\n    SAVEVOTE: \"[data-action='savevote']\"\n};\n\n/**\n * Save sort vote.\n * @param {Element} saveSortVoteElement\n */\nconst saveVote = function(saveSortVoteElement) {\n    saveSortVoteElement.setAttribute('disabled', true);\n    var sortvotingid = document.getElementsByName('sortvotingid')[0].value;\n    var options = document.getElementsByName('option[]');\n    var votes = [];\n    options.forEach(function (option) {\n        votes.push({\n            'position': option.value,\n            'optionid': option.getAttribute('data-optionid')\n        });\n    });\n    var promises = Ajax.call([\n        {methodname: 'mod_sortvoting_save_vote', args: {sortvotingid: sortvotingid, votes: votes}}\n    ]);\n    promises[0].done(function() {\n        window.location.reload();\n    }).fail(Notification.exception);\n};\n\n/**\n * Init page\n */\nexport function init() {\n    document.addEventListener('click', event => {\n\n        // Save sort vote.\n        const saveSortVoteElement = event.target.closest(SELECTORS.SAVEVOTE);\n        if (saveSortVoteElement) {\n            event.preventDefault();\n            saveVote(saveSortVoteElement);\n        }\n    });\n}\n"],"names":["document","addEventListener","event","saveSortVoteElement","target","closest","SELECTORS","preventDefault","setAttribute","sortvotingid","getElementsByName","value","options","votes","forEach","option","push","getAttribute","Ajax","call","methodname","args","done","window","location","reload","fail","Notification","exception","saveVote"],"mappings":";;;;;;;sFAuDIA,SAASC,iBAAiB,SAASC,cAGzBC,oBAAsBD,MAAME,OAAOC,QAAQC,oBAC7CH,sBACAD,MAAMK,iBA5BD,SAASJ,qBACtBA,oBAAoBK,aAAa,YAAY,OACzCC,aAAeT,SAASU,kBAAkB,gBAAgB,GAAGC,MAC7DC,QAAUZ,SAASU,kBAAkB,YACrCG,MAAQ,GACZD,QAAQE,SAAQ,SAAUC,QACtBF,MAAMG,KAAK,UACKD,OAAOJ,eACPI,OAAOE,aAAa,sBAGzBC,cAAKC,KAAK,CACrB,CAACC,WAAY,2BAA4BC,KAAM,CAACZ,aAAcA,aAAcI,MAAOA,UAE9E,GAAGS,MAAK,WACbC,OAAOC,SAASC,YACjBC,KAAKC,sBAAaC,WAabC,CAAS1B,wHArCfG,mBACQ"}